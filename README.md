# Malware Visualization

Do this in binaryninja because:
 - Can go on binaryninja stream
 - Can use MLIL and HLIL for data flow analysis
 - Can use tagging system
 - Has best UI of all the tools
 - Python is easiest for machine learning

## Research ideas
 - Granular malware identification with machine learning on function semantics

---

## Schedule
### Weeks 1-3
 - Write plugin to facilitate malware tagging
 - Analyze malware to design visualizations
   - Tag each malware function with size, complexity, call count, system call list, function classification (network, OS, etc) and importance
   - Run data analysis to correlate various function features with importance
   - Machine learning model to predict importance
 - Determine what data to tag
 - Prototype custom graph
 - Prototype custom function listing
 - Think about applications of recommender systems, other new ideas

### Weeks 4-6
 - Write analysis pass to identify important elements
 - Write data-flow tracer or integrate BAP taint
 - Graph function summary using these elements
 - Understand if generative grammar is possible

### Weeks 7-9
 - Generative grammar function descriptions
 - Machine learning malware classification on 1) high level representation, 2) generative grammar function description
 - Rate functions by their maliciousness?

### Weeks 10-12

### Weeks 13-15

 


---

## Final Plan
 - Basic plugin for custom function listing
   - Dynamic function sorting (using importance, height in call tree, understandability (are calls known), complexity, hide some
   - List in tree form, use heuristics to organize like original code base folder structure
   - Function classification (networking, file, memory, etc)
   - Understandablity rating
 - Function level visualization
   - Build function summary graph
   - Extract important features to add to function summary
   - Simplify function summary graph
   - Propogate info using data flow or HLIL variables. For example, can specify file name from read, propogates name to all file writes and network sends.
   - ALIL (abstract level il)
 - Function generative grammar
   - Generative grammar to create description for function
   - Add description to custom function listing
 - Binary level visualization
   - Visualize entire call graph
   - Label call graph with high level properties
   - Simplify entire call graph
   - Propogate info using data flow or HLIL variables. For example, can specify file name from read, propogates name to all file writes and network sends.
 - Binary ninja views enhancements
   - Add dangerous functions as red dots on feature map
   - Automatically rename functions
 - Survey
   - Plugin to record reversing session - time spent in function, function importance rating, function visit order
   - Get participants to reverse engineer the malware. See if total time, time spent in unimportant functions, etc are reduced. Split data set into A and B set, participants can use visualization tools on half the set, see if time to understand malware is reduced.
 - Debugger stuff
 

---

## Concrete Ideas
### New function list
 - Sort functions by importance, hide some
 - Classify function as "networking", "file", etc in column
 - Generate text description of what function does
 - Column for understandability rating, based on if calls are known, complexity, etc
 - If function only called by one other, then list it as a sub-function in the list (indented and below the calling function)
 
### RE observing statistics
 - Take data of reverse engineers analyzing malware
 - Run statistical analysis to determine what high-level features correlate with analysis time and order
 - Use high level features like function classification, complexity, height in call tree, etc with statistical analysis
 - Have reverse engineers mark the importance of each function to use with statistical analysis
 
### Function level visualizations
 - Generative grammar description for what function does
 - Advanced function summary graph with various properties

### Binary level visualizations
 - Call graph of the entire binary, but each node contains high-level properties. Only include important functions.

### Debugger
 - Instrument run with qiling/pin/frida. Highlight graph with code coverage, labeling function call args. Generate report summarizing run. Can click on places in report to inspect memory, etc.

---

## Other
 - Binary visualization to facilitate exploitation
 - Dynamic binary visualization for debugging
 - Visualize the last debug session
 - Something with abstract interpretation
 - Visualize symbolic execution in 3D
 - Recommender system for function investigation order
